import{i as te,a as H,r as ie,l as X,s as ne}from"./breakdance-BWcupbPN.js";import{K as V,w as re,q as D}from"./runtime-core.esm-bundler-PtAo0so5.js";var se=/\s/;function oe(r){for(var e=r.length;e--&&se.test(r.charAt(e)););return e}var le=/^\s+/;function ae(r){return r&&r.slice(0,oe(r)+1).replace(le,"")}var Y=NaN,ue=/^[-+]0x[0-9a-f]+$/i,ce=/^0b[01]+$/i,he=/^0o[0-7]+$/i,de=parseInt;function U(r){if(typeof r=="number")return r;if(te(r))return Y;if(H(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=H(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=ae(r);var t=ce.test(r);return t||he.test(r)?de(r.slice(2),t?2:8):ue.test(r)?Y:+r}var F=function(){return ie.Date.now()},fe="Expected a function",pe=Math.max,me=Math.min;function ge(r,e,t){var i,n,s,o,l,a,u=0,c=!1,d=!1,h=!0;if(typeof r!="function")throw new TypeError(fe);e=U(e)||0,H(t)&&(c=!!t.leading,d="maxWait"in t,s=d?pe(U(t.maxWait)||0,e):s,h="trailing"in t?!!t.trailing:h);function p(f){var v=i,S=n;return i=n=void 0,u=f,o=r.apply(S,v),o}function g(f){return u=f,l=setTimeout(T,e),c?p(f):o}function w(f){var v=f-a,S=f-u,m=e-v;return d?me(m,s-S):m}function b(f){var v=f-a,S=f-u;return a===void 0||v>=e||v<0||d&&S>=s}function T(){var f=F();if(b(f))return C(f);l=setTimeout(T,w(f))}function C(f){return l=void 0,h&&i?p(f):(i=n=void 0,o)}function k(){l!==void 0&&clearTimeout(l),u=0,i=a=n=l=void 0}function E(){return l===void 0?o:C(F())}function x(){var f=F(),v=b(f);if(i=arguments,n=this,a=f,v){if(l===void 0)return g(a);if(d)return clearTimeout(l),l=setTimeout(T,e),p(a)}return l===void 0&&(l=setTimeout(T,e)),o}return x.cancel=k,x.flush=E,x}var N=new Map;function be(r){var e=N.get(r);e&&e.destroy()}function ve(r){var e=N.get(r);e&&e.update()}var M=null;typeof window>"u"?((M=function(r){return r}).destroy=function(r){return r},M.update=function(r){return r}):((M=function(r,e){return r&&Array.prototype.forEach.call(r.length?r:[r],function(t){return function(i){if(i&&i.nodeName&&i.nodeName==="TEXTAREA"&&!N.has(i)){var n,s=null,o=window.getComputedStyle(i),l=(n=i.value,function(){u({testForHeightReduction:n===""||!i.value.startsWith(n),restoreTextAlign:null}),n=i.value}),a=(function(d){i.removeEventListener("autosize:destroy",a),i.removeEventListener("autosize:update",c),i.removeEventListener("input",l),window.removeEventListener("resize",c),Object.keys(d).forEach(function(h){return i.style[h]=d[h]}),N.delete(i)}).bind(i,{height:i.style.height,resize:i.style.resize,textAlign:i.style.textAlign,overflowY:i.style.overflowY,overflowX:i.style.overflowX,wordWrap:i.style.wordWrap});i.addEventListener("autosize:destroy",a),i.addEventListener("autosize:update",c),i.addEventListener("input",l),window.addEventListener("resize",c),i.style.overflowX="hidden",i.style.wordWrap="break-word",N.set(i,{destroy:a,update:c}),c()}function u(d){var h,p,g=d.restoreTextAlign,w=g===void 0?null:g,b=d.testForHeightReduction,T=b===void 0||b,C=o.overflowY;if(i.scrollHeight!==0&&(o.resize==="vertical"?i.style.resize="none":o.resize==="both"&&(i.style.resize="horizontal"),T&&(h=function(E){for(var x=[];E&&E.parentNode&&E.parentNode instanceof Element;)E.parentNode.scrollTop&&x.push([E.parentNode,E.parentNode.scrollTop]),E=E.parentNode;return function(){return x.forEach(function(f){var v=f[0],S=f[1];v.style.scrollBehavior="auto",v.scrollTop=S,v.style.scrollBehavior=null})}}(i),i.style.height=""),p=o.boxSizing==="content-box"?i.scrollHeight-(parseFloat(o.paddingTop)+parseFloat(o.paddingBottom)):i.scrollHeight+parseFloat(o.borderTopWidth)+parseFloat(o.borderBottomWidth),o.maxHeight!=="none"&&p>parseFloat(o.maxHeight)?(o.overflowY==="hidden"&&(i.style.overflow="scroll"),p=parseFloat(o.maxHeight)):o.overflowY!=="hidden"&&(i.style.overflow="hidden"),i.style.height=p+"px",w&&(i.style.textAlign=w),h&&h(),s!==p&&(i.dispatchEvent(new Event("autosize:resized",{bubbles:!0})),s=p),C!==o.overflow&&!w)){var k=o.textAlign;o.overflow==="hidden"&&(i.style.textAlign=k==="start"?"end":"start"),u({restoreTextAlign:k,testForHeightReduction:!0})}}function c(){u({testForHeightReduction:!0,restoreTextAlign:null})}}(t)}),r}).destroy=function(r){return r&&Array.prototype.forEach.call(r.length?r:[r],be),r},M.update=function(r){return r&&Array.prototype.forEach.call(r.length?r:[r],ve),r});var Q=M;Array.prototype.find||(Array.prototype.find=function(r){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof r!="function")throw new TypeError("predicate must be a function");for(var e=Object(this),t=e.length>>>0,i=arguments[1],n,s=0;s<t;s++)if(n=e[s],r.call(i,n,s,e))return n});if(window&&typeof window.CustomEvent!="function"){let r=function(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var i=document.createEvent("CustomEvent");return i.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),i};typeof window.Event<"u"&&(r.prototype=window.Event.prototype),window.CustomEvent=r}class O{constructor(e){this.tribute=e,this.tribute.events=this}static keys(){return[{key:9,value:"TAB"},{key:8,value:"DELETE"},{key:13,value:"ENTER"},{key:27,value:"ESCAPE"},{key:32,value:"SPACE"},{key:38,value:"UP"},{key:40,value:"DOWN"}]}bind(e){e.boundKeydown=this.keydown.bind(e,this),e.boundKeyup=this.keyup.bind(e,this),e.boundInput=this.input.bind(e,this),e.addEventListener("keydown",e.boundKeydown,!1),e.addEventListener("keyup",e.boundKeyup,!1),e.addEventListener("input",e.boundInput,!1)}unbind(e){e.removeEventListener("keydown",e.boundKeydown,!1),e.removeEventListener("keyup",e.boundKeyup,!1),e.removeEventListener("input",e.boundInput,!1),delete e.boundKeydown,delete e.boundKeyup,delete e.boundInput}keydown(e,t){e.shouldDeactivate(t)&&(e.tribute.isActive=!1,e.tribute.hideMenu());let i=this;e.commandEvent=!1,O.keys().forEach(n=>{n.key===t.keyCode&&(e.commandEvent=!0,e.callbacks()[n.value.toLowerCase()](t,i))})}input(e,t){e.inputEvent=!0,e.keyup.call(this,e,t)}click(e,t){let i=e.tribute;if(i.menu&&i.menu.contains(t.target)){let n=t.target;for(t.preventDefault(),t.stopPropagation();n.nodeName.toLowerCase()!=="li";)if(n=n.parentNode,!n||n===i.menu)throw new Error("cannot find the <li> container for the click");i.selectItemAtIndex(n.getAttribute("data-index"),t),i.hideMenu()}else i.current.element&&!i.current.externalTrigger&&(i.current.externalTrigger=!1,setTimeout(()=>i.hideMenu()))}keyup(e,t){if(e.inputEvent&&(e.inputEvent=!1),e.updateSelection(this),t.keyCode!==27){if(!e.tribute.allowSpaces&&e.tribute.hasTrailingSpace){e.tribute.hasTrailingSpace=!1,e.commandEvent=!0,e.callbacks().space(t,this);return}if(!e.tribute.isActive)if(e.tribute.autocompleteMode)e.callbacks().triggerChar(t,this,"");else{let i=e.getKeyCode(e,this,t);if(isNaN(i)||!i)return;let n=e.tribute.triggers().find(s=>s.charCodeAt(0)===i);typeof n<"u"&&e.callbacks().triggerChar(t,this,n)}e.tribute.current.mentionText.length<e.tribute.current.collection.menuShowMinLength||((e.tribute.current.trigger||e.tribute.autocompleteMode)&&e.commandEvent===!1||e.tribute.isActive&&t.keyCode===8)&&e.tribute.showMenuFor(this,!0)}}shouldDeactivate(e){if(!this.tribute.isActive)return!1;if(this.tribute.current.mentionText.length===0){let t=!1;return O.keys().forEach(i=>{e.keyCode===i.key&&(t=!0)}),!t}return!1}getKeyCode(e,t,i){let n=e.tribute,s=n.range.getTriggerInfo(!1,n.hasTrailingSpace,!0,n.allowSpaces,n.autocompleteMode);return s?s.mentionTriggerChar.charCodeAt(0):!1}updateSelection(e){this.tribute.current.element=e;let t=this.tribute.range.getTriggerInfo(!1,this.tribute.hasTrailingSpace,!0,this.tribute.allowSpaces,this.tribute.autocompleteMode);t&&(this.tribute.current.selectedPath=t.mentionSelectedPath,this.tribute.current.mentionText=t.mentionText,this.tribute.current.selectedOffset=t.mentionSelectedOffset)}callbacks(){return{triggerChar:(e,t,i)=>{let n=this.tribute;n.current.trigger=i;let s=n.collection.find(o=>o.trigger===i);n.current.collection=s,n.current.mentionText.length>=n.current.collection.menuShowMinLength&&n.inputEvent&&n.showMenuFor(t,!0)},enter:(e,t)=>{this.tribute.isActive&&this.tribute.current.filteredItems&&(e.preventDefault(),e.stopPropagation(),setTimeout(()=>{this.tribute.selectItemAtIndex(this.tribute.menuSelected,e),this.tribute.hideMenu()},0))},escape:(e,t)=>{this.tribute.isActive&&(e.preventDefault(),e.stopPropagation(),this.tribute.isActive=!1,this.tribute.hideMenu())},tab:(e,t)=>{this.callbacks().enter(e,t)},space:(e,t)=>{this.tribute.isActive&&(this.tribute.spaceSelectsMatch?this.callbacks().enter(e,t):this.tribute.allowSpaces||(e.stopPropagation(),setTimeout(()=>{this.tribute.hideMenu(),this.tribute.isActive=!1},0)))},up:(e,t)=>{if(this.tribute.isActive&&this.tribute.current.filteredItems){e.preventDefault(),e.stopPropagation();let i=this.tribute.current.filteredItems.length,n=this.tribute.menuSelected;i>n&&n>0?(this.tribute.menuSelected--,this.setActiveLi()):n===0&&(this.tribute.menuSelected=i-1,this.setActiveLi(),this.tribute.menu.scrollTop=this.tribute.menu.scrollHeight)}},down:(e,t)=>{if(this.tribute.isActive&&this.tribute.current.filteredItems){e.preventDefault(),e.stopPropagation();let i=this.tribute.current.filteredItems.length-1,n=this.tribute.menuSelected;i>n?(this.tribute.menuSelected++,this.setActiveLi()):i===n&&(this.tribute.menuSelected=0,this.setActiveLi(),this.tribute.menu.scrollTop=0)}},delete:(e,t)=>{this.tribute.isActive&&this.tribute.current.mentionText.length<1?this.tribute.hideMenu():this.tribute.isActive&&this.tribute.showMenuFor(t)}}}setActiveLi(e){let t=this.tribute.menu.querySelectorAll("li"),i=t.length>>>0;e&&(this.tribute.menuSelected=parseInt(e));for(let n=0;n<i;n++){let s=t[n];if(n===this.tribute.menuSelected){s.classList.add(this.tribute.current.collection.selectClass);let o=s.getBoundingClientRect(),l=this.tribute.menu.getBoundingClientRect();if(o.bottom>l.bottom){let a=o.bottom-l.bottom;this.tribute.menu.scrollTop+=a}else if(o.top<l.top){let a=l.top-o.top;this.tribute.menu.scrollTop-=a}}else s.classList.remove(this.tribute.current.collection.selectClass)}}getFullHeight(e,t){let i=e.getBoundingClientRect().height;if(t){let n=e.currentStyle||window.getComputedStyle(e);return i+parseFloat(n.marginTop)+parseFloat(n.marginBottom)}return i}}class we{constructor(e){this.tribute=e,this.tribute.menuEvents=this,this.menu=this.tribute.menu}bind(e){this.menuClickEvent=this.tribute.events.click.bind(null,this),this.menuContainerScrollEvent=this.debounce(()=>{this.tribute.isActive&&this.tribute.hideMenu()},10,!1),this.windowResizeEvent=this.debounce(()=>{this.tribute.isActive&&this.tribute.hideMenu()},10,!1),this.tribute.range.getDocument().addEventListener("MSPointerDown",this.menuClickEvent,!1),this.tribute.range.getDocument().addEventListener("mousedown",this.menuClickEvent,!1),window.addEventListener("resize",this.windowResizeEvent),this.menuContainer?this.menuContainer.addEventListener("scroll",this.menuContainerScrollEvent,!1):window.addEventListener("scroll",this.menuContainerScrollEvent)}unbind(e){this.tribute.range.getDocument().removeEventListener("mousedown",this.menuClickEvent,!1),this.tribute.range.getDocument().removeEventListener("MSPointerDown",this.menuClickEvent,!1),window.removeEventListener("resize",this.windowResizeEvent),this.menuContainer?this.menuContainer.removeEventListener("scroll",this.menuContainerScrollEvent,!1):window.removeEventListener("scroll",this.menuContainerScrollEvent)}debounce(e,t,i){var n;return()=>{var s=this,o=arguments,l=()=>{n=null,i||e.apply(s,o)},a=i&&!n;clearTimeout(n),n=setTimeout(l,t),a&&e.apply(s,o)}}}class ye{constructor(e){this.tribute=e,this.tribute.range=this}getDocument(){let e;return this.tribute.current.collection&&(e=this.tribute.current.collection.iframe),e?e.contentWindow.document:document}positionMenuAtCaret(e){let t=this.tribute.current,i,n=this.getTriggerInfo(!1,this.tribute.hasTrailingSpace,!0,this.tribute.allowSpaces,this.tribute.autocompleteMode);if(typeof n<"u"){if(!this.tribute.positionMenu){this.tribute.menu.style.cssText="display: block;";return}this.isContentEditable(t.element)?i=this.getContentEditableCaretPosition(n.mentionPosition):i=this.getTextAreaOrInputUnderlinePosition(this.tribute.current.element,n.mentionPosition),this.tribute.menu.style.cssText=`top: ${i.top}px;
                                     left: ${i.left}px;
                                     right: ${i.right}px;
                                     bottom: ${i.bottom}px;
                                     max-height: ${i.maxHeight||500}px;
                                     max-width: ${i.maxWidth||300}px;
                                     position: ${i.position||"absolute"};
                                     display: block;`,i.left==="auto"&&(this.tribute.menu.style.left="auto"),i.top==="auto"&&(this.tribute.menu.style.top="auto"),e&&this.scrollIntoView()}else this.tribute.menu.style.cssText="display: none"}get menuContainerIsBody(){return this.tribute.menuContainer===document.body||!this.tribute.menuContainer}selectElement(e,t,i){let n,s=e;if(t)for(var o=0;o<t.length;o++){if(s=s.childNodes[t[o]],s===void 0)return;for(;s.length<i;)i-=s.length,s=s.nextSibling;s.childNodes.length===0&&!s.length&&(s=s.previousSibling)}let l=this.getWindowSelection();n=this.getDocument().createRange(),n.setStart(s,i),n.setEnd(s,i),n.collapse(!0);try{l.removeAllRanges()}catch{}l.addRange(n),e.focus()}replaceTriggerText(e,t,i,n,s){let o=this.getTriggerInfo(!0,i,t,this.tribute.allowSpaces,this.tribute.autocompleteMode);if(o!==void 0){let l=this.tribute.current,a=new CustomEvent("tribute-replaced",{detail:{item:s,instance:l,context:o,event:n}});if(this.isContentEditable(l.element)){let u=typeof this.tribute.replaceTextSuffix=="string"?this.tribute.replaceTextSuffix:" ";e+=u;let c=o.mentionPosition+o.mentionText.length;this.tribute.autocompleteMode||(c+=o.mentionTriggerChar.length),this.pasteHtml(e,o.mentionPosition,c)}else{let u=this.tribute.current.element,c=typeof this.tribute.replaceTextSuffix=="string"?this.tribute.replaceTextSuffix:" ";e+=c;let d=o.mentionPosition,h=o.mentionPosition+o.mentionText.length+c.length;this.tribute.autocompleteMode||(h+=o.mentionTriggerChar.length-1),u.value=u.value.substring(0,d)+e+u.value.substring(h,u.value.length),u.selectionStart=d+e.length,u.selectionEnd=d+e.length}l.element.dispatchEvent(new CustomEvent("input",{bubbles:!0})),l.element.dispatchEvent(a)}}pasteHtml(e,t,i){let n,s;s=this.getWindowSelection(),n=this.getDocument().createRange(),n.setStart(s.anchorNode,t),n.setEnd(s.anchorNode,i),n.deleteContents();let o=this.getDocument().createElement("div");o.innerHTML=e;let l=this.getDocument().createDocumentFragment(),a,u;for(;a=o.firstChild;)u=l.appendChild(a);n.insertNode(l),u&&(n=n.cloneRange(),n.setStartAfter(u),n.collapse(!0),s.removeAllRanges(),s.addRange(n))}getWindowSelection(){return this.tribute.collection.iframe?this.tribute.collection.iframe.contentWindow.getSelection():window.getSelection()}getNodePositionInParent(e){if(e.parentNode===null)return 0;for(var t=0;t<e.parentNode.childNodes.length;t++)if(e.parentNode.childNodes[t]===e)return t}getContentEditableSelectedPath(e){let t=this.getWindowSelection(),i=t.anchorNode,n=[],s;if(i!=null){let o,l=i.contentEditable;for(;i!==null&&l!=="true";)o=this.getNodePositionInParent(i),n.push(o),i=i.parentNode,i!==null&&(l=i.contentEditable);return n.reverse(),s=t.getRangeAt(0).startOffset,{selected:i,path:n,offset:s}}}getTextPrecedingCurrentSelection(){let e=this.tribute.current,t="";if(this.isContentEditable(e.element)){let i=this.getWindowSelection().anchorNode;if(i!=null){let n=i.textContent,s=this.getWindowSelection().getRangeAt(0).startOffset;n&&s>=0&&(t=n.substring(0,s))}}else{let i=this.tribute.current.element;if(i){let n=i.selectionStart;i.value&&n>=0&&(t=i.value.substring(0,n))}}return t}getLastWordInText(e){e=e.replace(/\u00A0/g," ");var t;this.tribute.autocompleteSeparator?t=e.split(this.tribute.autocompleteSeparator):t=e.split(/\s+/);var i=t.length-1;return t[i].trim()}getTriggerInfo(e,t,i,n,s){let o=this.tribute.current,l,a,u;if(!this.isContentEditable(o.element))l=this.tribute.current.element;else{let h=this.getContentEditableSelectedPath(o);h&&(l=h.selected,a=h.path,u=h.offset)}let c=this.getTextPrecedingCurrentSelection(),d=this.getLastWordInText(c);if(s)return{mentionPosition:c.length-d.length,mentionText:d,mentionSelectedElement:l,mentionSelectedPath:a,mentionSelectedOffset:u};if(c!=null){let h=-1,p;if(this.tribute.collection.forEach(g=>{let w=g.trigger,b=g.requireLeadingSpace?this.lastIndexWithLeadingSpace(c,w):c.lastIndexOf(w);b>h&&(h=b,p=w,i=g.requireLeadingSpace)}),h>=0&&(h===0||!i||/[\xA0\s]/g.test(c.substring(h-1,h)))){let g=c.substring(h+p.length,c.length);p=c.substring(h,h+p.length);let w=g.substring(0,1),b=g.length>0&&(w===" "||w===" ");t&&(g=g.trim());let T=n?/[^\S ]/g:/[\xA0\s]/g;if(this.tribute.hasTrailingSpace=T.test(g),!b&&(e||!T.test(g)))return{mentionPosition:h,mentionText:g,mentionSelectedElement:l,mentionSelectedPath:a,mentionSelectedOffset:u,mentionTriggerChar:p}}}}lastIndexWithLeadingSpace(e,t){let i=e.split("").reverse().join(""),n=-1;for(let s=0,o=e.length;s<o;s++){let l=s===e.length-1,a=/\s/.test(i[s+1]),u=!0;for(let c=t.length-1;c>=0;c--)if(t[c]!==i[s-c]){u=!1;break}if(u&&(l||a)){n=e.length-1-s;break}}return n}isContentEditable(e){return e.nodeName!=="INPUT"&&e.nodeName!=="TEXTAREA"}isMenuOffScreen(e,t){let i=window.innerWidth,n=window.innerHeight,s=document.documentElement,o=(window.pageXOffset||s.scrollLeft)-(s.clientLeft||0),l=(window.pageYOffset||s.scrollTop)-(s.clientTop||0),a=typeof e.top=="number"?e.top:l+n-e.bottom-t.height,u=typeof e.right=="number"?e.right:e.left+t.width,c=typeof e.bottom=="number"?e.bottom:e.top+t.height,d=typeof e.left=="number"?e.left:o+i-e.right-t.width;return{top:a<Math.floor(l),right:u>Math.ceil(o+i),bottom:c>Math.ceil(l+n),left:d<Math.floor(o)}}getMenuDimensions(){let e={width:null,height:null};return this.tribute.menu.style.cssText=`top: 0px;
                                 left: 0px;
                                 position: fixed;
                                 display: block;
                                 visibility; hidden;
                                 max-height:500px;`,e.width=this.tribute.menu.offsetWidth,e.height=this.tribute.menu.offsetHeight,this.tribute.menu.style.cssText="display: none;",e}getTextAreaOrInputUnderlinePosition(e,t,i){let n=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing"],s=this.getDocument().createElement("div");s.id="input-textarea-caret-position-mirror-div",this.getDocument().body.appendChild(s);let o=s.style,l=window.getComputedStyle?getComputedStyle(e):e.currentStyle;o.whiteSpace="pre-wrap",e.nodeName!=="INPUT"&&(o.wordWrap="break-word"),o.position="absolute",o.visibility="hidden",n.forEach(p=>{o[p]=l[p]});let a=document.createElement("span");a.textContent=e.value.substring(0,t),s.appendChild(a),e.nodeName==="INPUT"&&(s.textContent=s.textContent.replace(/\s/g," "));let u=this.getDocument().createElement("span");u.textContent="&#x200B;",s.appendChild(u);let c=this.getDocument().createElement("span");c.textContent=e.value.substring(t),s.appendChild(c);let d=e.getBoundingClientRect();s.style.position="fixed",s.style.left=d.left+"px",s.style.top=d.top+"px",s.style.width=d.width+"px",s.style.height=d.height+"px",s.scrollTop=e.scrollTop;var h=u.getBoundingClientRect();return this.getDocument().body.removeChild(s),this.getFixedCoordinatesRelativeToRect(h)}getContentEditableCaretPosition(e){let t,i=this.getWindowSelection();t=this.getDocument().createRange(),t.setStart(i.anchorNode,e),t.setEnd(i.anchorNode,e),t.collapse(!1);let n=t.getBoundingClientRect();return this.getFixedCoordinatesRelativeToRect(n)}getFixedCoordinatesRelativeToRect(e){let t={position:"fixed",left:e.left,top:e.top+e.height},i=this.getMenuDimensions();var n=e.top,s=window.innerHeight-(e.top+e.height);s<i.height&&(n>=i.height||n>s?(t.top="auto",t.bottom=window.innerHeight-e.top,s<i.height&&(t.maxHeight=n)):n<i.height&&(t.maxHeight=s));var o=e.left,l=window.innerWidth-e.left;return l<i.width&&(o>=i.width||o>l?(t.left="auto",t.right=window.innerWidth-e.left,l<i.width&&(t.maxWidth=o)):o<i.width&&(t.maxWidth=l)),t}scrollIntoView(e){let t=20,i,n=100,s=this.menu;if(typeof s>"u")return;for(;i===void 0||i.height===0;)if(i=s.getBoundingClientRect(),i.height===0&&(s=s.childNodes[0],s===void 0||!s.getBoundingClientRect))return;let o=i.top,l=o+i.height;if(o<0)window.scrollTo(0,window.pageYOffset+i.top-t);else if(l>window.innerHeight){let a=window.pageYOffset+i.top-t;a-window.pageYOffset>n&&(a=window.pageYOffset+n);let u=window.pageYOffset-(window.innerHeight-l);u>a&&(u=a),window.scrollTo(0,u)}}}class Ee{constructor(e){this.tribute=e,this.tribute.search=this}simpleFilter(e,t){return t.filter(i=>this.test(e,i))}test(e,t){return this.match(e,t)!==null}match(e,t,i){i=i||{},t.length;let n=i.pre||"",s=i.post||"",o=i.caseSensitive&&t||t.toLowerCase();if(i.skip)return{rendered:t,score:0};e=i.caseSensitive&&e||e.toLowerCase();let l=this.traverse(o,e,0,0,[]);return l?{rendered:this.render(t,l.cache,n,s),score:l.score}:null}traverse(e,t,i,n,s){if(this.tribute.autocompleteSeparator&&(t=t.split(this.tribute.autocompleteSeparator).splice(-1)[0]),t.length===n)return{score:this.calculateScore(s),cache:s.slice()};if(e.length===i||t.length-n>e.length-i)return;let o=t[n],l=e.indexOf(o,i),a,u;for(;l>-1;){if(s.push(l),u=this.traverse(e,t,l+1,n+1,s),s.pop(),!u)return a;(!a||a.score<u.score)&&(a=u),l=e.indexOf(o,l+1)}return a}calculateScore(e){let t=0,i=1;return e.forEach((n,s)=>{s>0&&(e[s-1]+1===n?i+=i+1:i=1),t+=i}),t}render(e,t,i,n){var s=e.substring(0,t[0]);return t.forEach((o,l)=>{s+=i+e[o]+n+e.substring(o+1,t[l+1]?t[l+1]:e.length)}),s}filter(e,t,i){return i=i||{},t.reduce((n,s,o,l)=>{let a=s;i.extract&&(a=i.extract(s),a||(a=""));let u=this.match(e,a,i);return u!=null&&(n[n.length]={string:u.rendered,score:u.score,index:o,original:s}),n},[]).sort((n,s)=>{let o=s.score-n.score;return o||n.index-s.index})}}class A{constructor({values:e=null,loadingItemTemplate:t=null,iframe:i=null,selectClass:n="highlight",containerClass:s="tribute-container",itemClass:o="",trigger:l="@",autocompleteMode:a=!1,autocompleteSeparator:u=null,selectTemplate:c=null,menuItemTemplate:d=null,lookup:h="key",fillAttr:p="value",collection:g=null,menuContainer:w=null,noMatchTemplate:b=null,requireLeadingSpace:T=!0,allowSpaces:C=!1,replaceTextSuffix:k=null,positionMenu:E=!0,spaceSelectsMatch:x=!1,searchOpts:f={},menuItemLimit:v=null,menuShowMinLength:S=0}){if(this.autocompleteMode=a,this.autocompleteSeparator=u,this.menuSelected=0,this.current={},this.inputEvent=!1,this.isActive=!1,this.menuContainer=w,this.allowSpaces=C,this.replaceTextSuffix=k,this.positionMenu=E,this.hasTrailingSpace=!1,this.spaceSelectsMatch=x,this.autocompleteMode&&(l="",C=!1),e)this.collection=[{trigger:l,iframe:i,selectClass:n,containerClass:s,itemClass:o,selectTemplate:(c||A.defaultSelectTemplate).bind(this),menuItemTemplate:(d||A.defaultMenuItemTemplate).bind(this),noMatchTemplate:(m=>typeof m=="string"?m.trim()===""?null:m:typeof m=="function"?m.bind(this):b||(function(){return"<li>No Match Found!</li>"}).bind(this))(b),lookup:h,fillAttr:p,values:e,loadingItemTemplate:t,requireLeadingSpace:T,searchOpts:f,menuItemLimit:v,menuShowMinLength:S}];else if(g)this.autocompleteMode&&console.warn("Tribute in autocomplete mode does not work for collections"),this.collection=g.map(m=>({trigger:m.trigger||l,iframe:m.iframe||i,selectClass:m.selectClass||n,containerClass:m.containerClass||s,itemClass:m.itemClass||o,selectTemplate:(m.selectTemplate||A.defaultSelectTemplate).bind(this),menuItemTemplate:(m.menuItemTemplate||A.defaultMenuItemTemplate).bind(this),noMatchTemplate:(I=>typeof I=="string"?I.trim()===""?null:I:typeof I=="function"?I.bind(this):b||(function(){return"<li>No Match Found!</li>"}).bind(this))(b),lookup:m.lookup||h,fillAttr:m.fillAttr||p,values:m.values,loadingItemTemplate:m.loadingItemTemplate,requireLeadingSpace:m.requireLeadingSpace,searchOpts:m.searchOpts||f,menuItemLimit:m.menuItemLimit||v,menuShowMinLength:m.menuShowMinLength||S}));else throw new Error("[Tribute] No collection specified.");new ye(this),new O(this),new we(this),new Ee(this)}get isActive(){return this._isActive}set isActive(e){if(this._isActive!=e&&(this._isActive=e,this.current.element)){let t=new CustomEvent(`tribute-active-${e}`);this.current.element.dispatchEvent(t)}}static defaultSelectTemplate(e){return typeof e>"u"?`${this.current.collection.trigger}${this.current.mentionText}`:this.range.isContentEditable(this.current.element)?'<span class="tribute-mention">'+(this.current.collection.trigger+e.original[this.current.collection.fillAttr])+"</span>":this.current.collection.trigger+e.original[this.current.collection.fillAttr]}static defaultMenuItemTemplate(e){return e.string}static inputTypes(){return["TEXTAREA","INPUT"]}triggers(){return this.collection.map(e=>e.trigger)}attach(e){if(!e)throw new Error("[Tribute] Must pass in a DOM node or NodeList.");if(typeof jQuery<"u"&&e instanceof jQuery&&(e=e.get()),e.constructor===NodeList||e.constructor===HTMLCollection||e.constructor===Array){let i=e.length;for(var t=0;t<i;++t)this._attach(e[t])}else this._attach(e)}_attach(e){e.hasAttribute("data-tribute")&&console.warn("Tribute was already bound to "+e.nodeName),this.ensureEditable(e),this.events.bind(e),e.setAttribute("data-tribute",!0)}ensureEditable(e){if(A.inputTypes().indexOf(e.nodeName)===-1)if(e.contentEditable)e.contentEditable=!0;else throw new Error("[Tribute] Cannot bind to "+e.nodeName)}createMenu(e){let t=this.range.getDocument().createElement("div"),i=this.range.getDocument().createElement("ul");return t.className=e,t.appendChild(i),this.menuContainer?this.menuContainer.appendChild(t):this.range.getDocument().body.appendChild(t)}showMenuFor(e,t){if(this.isActive&&this.current.element===e&&this.current.mentionText===this.currentMentionTextSnapshot)return;this.currentMentionTextSnapshot=this.current.mentionText,this.menu||(this.menu=this.createMenu(this.current.collection.containerClass),e.tributeMenu=this.menu,this.menuEvents.bind(this.menu)),this.isActive=!0,this.menuSelected=0,this.current.mentionText||(this.current.mentionText="");const i=n=>{if(!this.isActive)return;let s=this.search.filter(this.current.mentionText,n,{pre:this.current.collection.searchOpts.pre||"<span>",post:this.current.collection.searchOpts.post||"</span>",skip:this.current.collection.searchOpts.skip,extract:a=>{if(typeof this.current.collection.lookup=="string")return a[this.current.collection.lookup];if(typeof this.current.collection.lookup=="function")return this.current.collection.lookup(a,this.current.mentionText);throw new Error("Invalid lookup attribute, lookup must be string or function.")}});this.current.collection.menuItemLimit&&(s=s.slice(0,this.current.collection.menuItemLimit)),this.current.filteredItems=s;let o=this.menu.querySelector("ul");if(!s.length){let a=new CustomEvent("tribute-no-match",{detail:this.menu});this.current.element.dispatchEvent(a),typeof this.current.collection.noMatchTemplate=="function"&&!this.current.collection.noMatchTemplate()||!this.current.collection.noMatchTemplate?this.hideMenu():(typeof this.current.collection.noMatchTemplate=="function"?o.innerHTML=this.current.collection.noMatchTemplate():o.innerHTML=this.current.collection.noMatchTemplate,this.range.positionMenuAtCaret(t));return}o.innerHTML="";let l=this.range.getDocument().createDocumentFragment();s.forEach((a,u)=>{let c=this.range.getDocument().createElement("li");c.setAttribute("data-index",u),c.className=this.current.collection.itemClass,c.addEventListener("mousemove",d=>{let[h,p]=this._findLiTarget(d.target);d.movementY!==0&&this.events.setActiveLi(p)}),this.menuSelected===u&&c.classList.add(this.current.collection.selectClass),c.innerHTML=this.current.collection.menuItemTemplate(a),l.appendChild(c)}),o.appendChild(l),this.range.positionMenuAtCaret(t)};typeof this.current.collection.values=="function"?(this.current.collection.loadingItemTemplate&&(this.menu.querySelector("ul").innerHTML=this.current.collection.loadingItemTemplate,this.range.positionMenuAtCaret(t)),this.current.collection.values(this.current.mentionText,i)):i(this.current.collection.values)}_findLiTarget(e){if(!e)return[];const t=e.getAttribute("data-index");return t?[e,t]:this._findLiTarget(e.parentNode)}showMenuForCollection(e,t){e!==document.activeElement&&this.placeCaretAtEnd(e),this.current.collection=this.collection[t||0],this.current.externalTrigger=!0,this.current.element=e,e.isContentEditable?this.insertTextAtCursor(this.current.collection.trigger):this.insertAtCaret(e,this.current.collection.trigger),this.showMenuFor(e)}placeCaretAtEnd(e){if(e.focus(),typeof window.getSelection<"u"&&typeof document.createRange<"u"){var t=document.createRange();t.selectNodeContents(e),t.collapse(!1);var i=window.getSelection();i.removeAllRanges(),i.addRange(t)}else if(typeof document.body.createTextRange<"u"){var n=document.body.createTextRange();n.moveToElementText(e),n.collapse(!1),n.select()}}insertTextAtCursor(e){var t,i;t=window.getSelection(),i=t.getRangeAt(0),i.deleteContents();var n=document.createTextNode(e);i.insertNode(n),i.selectNodeContents(n),i.collapse(!1),t.removeAllRanges(),t.addRange(i)}insertAtCaret(e,t){var i=e.scrollTop,n=e.selectionStart,s=e.value.substring(0,n),o=e.value.substring(e.selectionEnd,e.value.length);e.value=s+t+o,n=n+t.length,e.selectionStart=n,e.selectionEnd=n,e.focus(),e.scrollTop=i}hideMenu(){this.menu&&(this.menu.style.cssText="display: none;",this.isActive=!1,this.menuSelected=0,this.current={})}selectItemAtIndex(e,t){if(e=parseInt(e),typeof e!="number"||isNaN(e))return;let i=this.current.filteredItems[e],n=this.current.collection.selectTemplate(i);n!==null&&this.replaceText(n,t,i)}replaceText(e,t,i){this.range.replaceTriggerText(e,!0,!0,t,i)}_append(e,t,i){if(typeof e.values=="function")throw new Error("Unable to append to values, as it is a function.");i?e.values=t:e.values=e.values.concat(t)}append(e,t,i){let n=parseInt(e);if(typeof n!="number")throw new Error("please provide an index for the collection to update.");let s=this.collection[n];this._append(s,t,i)}appendCurrent(e,t){if(this.isActive)this._append(this.current.collection,e,t);else throw new Error("No active state. Please use append instead and pass an index.")}detach(e){if(!e)throw new Error("[Tribute] Must pass in a DOM node or NodeList.");if(typeof jQuery<"u"&&e instanceof jQuery&&(e=e.get()),e.constructor===NodeList||e.constructor===HTMLCollection||e.constructor===Array){let i=e.length;for(var t=0;t<i;++t)this._detach(e[t])}else this._detach(e)}_detach(e){this.events.unbind(e),e.tributeMenu&&this.menuEvents.unbind(e.tributeMenu),setTimeout(()=>{e.removeAttribute("data-tribute"),this.isActive=!1,e.tributeMenu&&e.tributeMenu.remove()})}}function W(r,e){this.init(r,e)}W.instance=function(r,e){return new W(r,e)};W.prototype={ID:"hit",init:function(r,e){typeof r=="string"?this.el=document.querySelector(r):this.el=r,this.getType(e)==="custom"?(this.highlight=e,this.generate()):console.error("valid config object not provided")},getType:function(r){let e=typeof r;if(r){if(Array.isArray(r))return r.length===2&&typeof r[0]=="number"&&typeof r[1]=="number"?"range":"array";if(e==="object"){if(r instanceof RegExp)return"regexp";if(r.hasOwnProperty("highlight"))return"custom"}else if(e==="function"||e==="string")return e}else return"falsey";return"other"},generate:function(){this.el.classList.add(this.ID+"-input",this.ID+"-content"),this.el.addEventListener("input",this.handleInput.bind(this)),this.el.addEventListener("scroll",this.handleScroll.bind(this)),this.highlights=document.createElement("div"),this.highlights.classList.add(this.ID+"-highlights",this.ID+"-content"),this.backdrop=document.createElement("div"),this.backdrop.classList.add(this.ID+"-backdrop"),this.backdrop.append(this.highlights),this.container=document.createElement("div"),this.container.classList.add(this.ID+"-container"),this.el.parentNode.insertBefore(this.container,this.el.nextSibling),this.container.append(this.backdrop),this.container.append(this.el),this.container.addEventListener("scroll",this.blockContainerScroll.bind(this)),this.handleInput()},handleInput:function(){let r=this.el.value,e=this.getRanges(r,this.highlight),t=this.removeStaggeredRanges(e),i=this.getBoundaries(t);this.renderMarks(i)},getRanges:function(r,e){switch(this.getType(e)){case"array":return this.getArrayRanges(r,e);case"function":return this.getFunctionRanges(r,e);case"regexp":return this.getRegExpRanges(r,e);case"string":return this.getStringRanges(r,e);case"range":return this.getRangeRanges(r,e);case"custom":return this.getCustomRanges(r,e);default:if(e)console.error("unrecognized highlight type");else return[]}},getArrayRanges:function(r,e){let t=e.map(this.getRanges.bind(this,r));return Array.prototype.concat.apply([],t)},getFunctionRanges:function(r,e){return this.getRanges(r,e(r))},getRegExpRanges:function(r,e){let t=[],i;for(;(i=e.exec(r),i!==null)&&(t.push([i.index,i.index+i[0].length]),!!e.global););return t},getStringRanges:function(r,e){let t=[],i=r.toLowerCase(),n=e.toLowerCase(),s=0;for(;s=i.indexOf(n,s),s!==-1;)t.push([s,s+n.length]),s+=n.length;return t},getRangeRanges:function(r,e){return[e]},getCustomRanges:function(r,e){let t=this.getRanges(r,e.highlight);return e.className&&t.forEach(function(i){i.className?i.className=e.className+" "+i.className:i.className=e.className}),e.blank&&t.forEach(function(i){i.blank=e.blank}),t},removeStaggeredRanges:function(r){let e=[];return r.forEach(function(t){e.some(function(n){let s=t[0]>n[0]&&t[0]<n[1],o=t[1]>n[0]&&t[1]<n[1];return s!==o})||e.push(t)}),e},getBoundaries:function(r){let e=[];return r.forEach(function(t){e.push({type:"start",index:t[0],className:t.className,blank:t.blank}),e.push({type:"stop",index:t[1]})}),this.sortBoundaries(e),e},sortBoundaries:function(r){r.sort(function(e,t){return e.index!==t.index?t.index-e.index:e.type==="stop"&&t.type==="start"?1:e.type==="start"&&t.type==="stop"?-1:0})},renderMarks:function(r){let e=this.el.value;r.forEach(function(t,i){let n;t.type==="start"?n="{{hit-mark-start|"+i+"}}":n="{{hit-mark-stop}}",e=e.slice(0,t.index)+n+e.slice(t.index)}),e=e.replace(/\n({{hit-mark-stop}})?$/,`

$1`),e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;"),e=e.replace(/{{hit-mark-start\|(\d+)}}/g,function(t,i){const n=r[+i].className;return n?'<mark class="'+n+'">':"<mark>"}),e=e.replace(/{{hit-mark-stop}}/g,"</mark>"),e+='<mark class="placeholder"> ⚡ </mark>',this.highlights.innerHTML=e},handleScroll:function(){this.backdrop.scrollTop=this.el.scrollTop;let r=this.el.scrollLeft;r>0?this.backdrop.style.transform="translateX("+-r+"px)":this.backdrop.style.transform=""},blockContainerScroll:function(){this.container.scrollLeft=0},destroy:function(){this.container.parentElement.replaceChild(this.el,this.container),this.el.classList.remove(this.ID+"-content",this.ID+"-input")}};const Te=document.querySelector("#app"),R=Te.__vue__;var K;const q=(K=document.querySelector("#app #iframe"))==null?void 0:K.contentDocument.querySelector("#breakdance_canvas"),z=q.__vue__;window.bdeV=R;window.bdeIframeV=z;const y=document.createElement("textarea");y.classList.add("movebender-plc-input");const _=document.createElement("div");_.classList.add("movebender-plc-input-container");_.appendChild(y);y.setAttribute("rows","1");y.setAttribute("spellcheck","false");const G=V(!1),J=V(null);let Z=null;Q(y);let ee=[];wp.hooks.addAction("movebender-autocomplete-items-refresh","movebender",()=>{ee=wp.hooks.applyFilters("movebender-autocomplete-items",[],y.value)});wp.hooks.doAction("movebender-autocomplete-items-refresh");const L=new A({containerClass:"movebender-tribute-container",autocompleteMode:!0,menuItemLimit:30,noMatchTemplate:"",values:async function(r,e){const t=await wp.hooks.applyFilters("movebender-autocomplete-items-query",ee,r);e(t)},lookup:"value",itemClass:"class-item",menuItemTemplate:function(r){let e="";return r.original.color!==void 0&&(e+=`background-color: ${r.original.color};`),r.original.fontWeight!==void 0&&(e+=`font-weight: ${r.original.fontWeight};`),`
            <span class="class-name" data-tribute-class-name="${r.original.value}">${r.string}</span>
            <span class="class-hint" style="${e}"></span>
        `}});L.setMenuContainer=function(r){this.menuContainer=r};const Se=L.events.callbacks;L.events.callbacks=function(){return{...Se.call(this),up:(r,e)=>{if(this.tribute.isActive&&this.tribute.current.filteredItems){r.preventDefault(),r.stopPropagation();let t=this.tribute.current.filteredItems.length,i=this.tribute.menuSelected;t>i&&i>0?(this.tribute.menuSelected--,this.setActiveLi()):i===0&&(this.tribute.menuSelected=t-1,this.setActiveLi(),this.tribute.menu.scrollTop=this.tribute.menu.scrollHeight),j()}},down:(r,e)=>{if(this.tribute.isActive&&this.tribute.current.filteredItems){r.preventDefault(),r.stopPropagation();let t=this.tribute.current.filteredItems.length-1,i=this.tribute.menuSelected;t>i?(this.tribute.menuSelected++,this.setActiveLi()):t===i&&(this.tribute.menuSelected=0,this.setActiveLi(),this.tribute.menu.scrollTop=0),j()}}}};L.attach(y);R.$store.subscribeAction((r,e)=>{r.type==="ui/activateElement"&&(J.value=r.payload),r.type==="ui/setLeftSidebarState"&&(G.value=r.payload==="elementproperties")});re([J,G],(r,e)=>{r[0]!==e[0]&&D(()=>{xe(),Le()}),r[0]&&r[1]&&D(()=>{const t=document.querySelector(".breakdance-element-properties-panel .vscroll-scroll .vscroll-scroll");t.querySelector(".movebender-plc-input")===null&&t.insertBefore(_,t.firstChild)})});Z=new W(y,{highlight:[{highlight:new RegExp("(?<=\\s|^)(?:(?!\\s).)+(?=\\s|$)","g"),className:"word"},{highlight:new RegExp("(?<=\\s)\\s","g"),className:"multispace",blank:!0}]});async function xe(){var r,e,t,i;y.value=((i=(t=(e=(r=R.$store.getters["ui/activeElement"].data.properties)==null?void 0:r.settings)==null?void 0:e.advanced)==null?void 0:t.classes)==null?void 0:i.join(" "))||""}async function Ce(){var s,o,l,a;if((a=(l=(o=(s=R.$store.getters["ui/activeElement"].data)==null?void 0:s.properties)==null?void 0:o.settings)==null?void 0:l.advanced)!=null&&a.classes)return!0;document.querySelector(".properties-panel-tab.breakdance-tab.breakdance-tab--id-settings").click();let e=document.querySelector("#settings .properties-panel-accordion.conditional-control-display-visible>div");for(;e===null;)e=document.querySelector("#settings .properties-panel-accordion.conditional-control-display-visible>div"),await new Promise(u=>setTimeout(u,100));e.parentElement.classList.contains("expanded")||e.click();let t=document.querySelector('#breakdance-class-input-search input[placeholder=".my-cool-class"]');for(;t===null;)t=document.querySelector('#breakdance-class-input-search input[placeholder=".my-cool-class"]'),await new Promise(u=>setTimeout(u,100));t.focus();const i="movebender";return t.value=i,t.dispatchEvent(new Event("input",{bubbles:!0})),await new Promise(u=>setTimeout(u,100)),document.querySelector("#breakdance-class-input-search>button").click(),!0}const Ae=ge(ke,50);async function ke(){if(!await Ce()){X("Upstream path not found!",{module:"plain-classes",type:"error"});return}y.focus(),ne(R.$store.getters["ui/activeElement"].data,"properties.settings.advanced.classes",y.value.trim().split(" ").filter(r=>r.trim()!=="")||[])}y.addEventListener("input",function(r){Ae()});function Le(){D(()=>{try{Z.handleInput()}catch{}Q.update(y),L.hideMenu()})}const Ie=new MutationObserver(function(r){r.forEach(function(e){e.type==="childList"&&e.addedNodes.length>0&&e.addedNodes.forEach(t=>{const i=t.querySelector(".class-name").dataset.tributeClassName;t.addEventListener("mouseenter",n=>{B(i)}),t.addEventListener("mouseleave",n=>{$()}),t.addEventListener("click",n=>{$(),B(i)})})})});let P=null;y.addEventListener("tribute-active-true",function(r){P===null&&(P=document.querySelector(".movebender-tribute-container>ul")),D(()=>{P&&Ie.observe(P,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class"]})})});function B(r){const e=z.$store.getters["ui/activeElement"].id,t=q.querySelector(`[data-node-id="${e}"]`);t.classList.add(r),t.dataset.tributeClassName=r}function $(){Me()}function j(){let r=L.menu.querySelector("li.highlight>span.class-name");$(),B(r.dataset.tributeClassName)}function Me(){const r=z.$store.getters["ui/activeElement"].id,e=q.querySelector(`[data-node-id="${r}"]`);e.dataset.tributeClassName&&(e.classList.remove(e.dataset.tributeClassName),e.dataset.tributeClassName="")}X("Module loaded!",{module:"plain-classes"});
